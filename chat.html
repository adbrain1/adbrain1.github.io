

<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/svg+xml" href="./favicon.svg?v=1">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Abdul Rafay‚Äôs Adventures</title>
  <style>
    :root {
      --bg: #0f172a; --card: #111827; --text: #e5e7eb;
      --muted: #9ca3af; --accent: #38bdf8; --chat-msg: #1e293b;
      --danger: #ef4444;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; min-height: 100vh; background: radial-gradient(circle at top, #1e293b, var(--bg));
      color: var(--text); font-family: system-ui, -apple-system, sans-serif;
      display: flex; flex-direction: column; align-items: center; padding: 24px; overflow-x: hidden;
    }

    .view-container { max-width: 1100px; width: 100%; margin-top: 40px; margin-bottom: 40px; }
    .card {
      width: 100%; background: linear-gradient(180deg, #0b1220, var(--card));
      border-radius: 20px; display: grid; grid-template-columns: 1fr 1fr; overflow: hidden;
      box-shadow: 0 40px 80px rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.05);
    }
    .content { padding: 40px; display: flex; flex-direction: column; justify-content: center; gap: 20px; }
    .image-panel img { width: 100%; height: 100%; object-fit: cover; }

    .chat-header { display: flex; justify-content: space-between; align-items: center; }
    .chat-portal { display: flex; flex-direction: column; gap: 15px; }
    .chat-input { background: #1e293b; border: 1px solid rgba(56,189,248,0.3); border-radius: 8px; padding: 12px; color: white; width: 100%; font-size: 1rem; }
    .chat-btn { background: var(--accent); color: #000; border: none; padding: 12px 20px; border-radius: 8px; font-weight: 700; cursor: pointer; transition: 0.2s; }
    
    .delete-btn { background: transparent; color: var(--danger); border: 1px solid var(--danger); padding: 5px 10px; border-radius: 6px; font-size: 0.75rem; cursor: pointer; }

    #chatBox { display: none; flex-direction: column; height: 450px; background: rgba(0,0,0,0.3); border-radius: 12px; border: 1px solid rgba(56,189,248,0.2); }
    #messages { flex-grow: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
    .msg { padding: 10px 14px; border-radius: 12px; background: var(--chat-msg); max-width: 85%; align-self: flex-start; border: 1px solid rgba(255,255,255,0.05); position: relative; }
    .msg.me { align-self: flex-end; background: var(--accent); color: #0f172a; font-weight: 500; }
    
    /* Timestamp Style */
    .ts { display: block; font-size: 0.65rem; margin-top: 4px; opacity: 0.7; }

    @media (max-width: 800px) { .card { grid-template-columns: 1fr; } }

/* ===== Hamburger Menu & Slide Bar ===== */
    .hamburger {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 2000;
      background: rgba(30,41,59,0.85);
      border: 1px solid var(--accent);
      color: var(--accent);
      padding: 10px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.5rem;
      backdrop-filter: blur(6px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      transition: transform 0.2s ease;
    }
    .hamburger:hover { transform: scale(1.05); }

    .slide-menu {
      position: fixed;
      top: 0;
      left: -320px;
      width: 300px;
      height: 100vh;
      background: var(--card);
      z-index: 2001;
      padding: 80px 30px;
      box-shadow: 10px 0 30px rgba(0,0,0,0.5);
      transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      gap: 20px;
      border-right: 1px solid rgba(56,189,248,0.2);
    }

    .slide-menu.open { left: 0; }

    .menu-item {
      text-decoration: none;
      color: var(--text);
      font-size: 1.2rem;
      font-weight: 600;
      padding: 12px 16px;
      border-radius: 8px;
      transition: background 0.2s, color 0.2s;
      border-left: 3px solid transparent;
    }

    .menu-item:hover {
      background: rgba(56,189,248,0.1);
      color: var(--accent);
      border-left: 3px solid var(--accent);
    }

    .close-menu {
      position: absolute;
      top: 20px;
      right: 20px;
      background: transparent;
      border: none;
      color: var(--muted);
      font-size: 2rem;
      cursor: pointer;
    }
    .close-menu:hover { color: var(--accent); }

    .menu-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 1999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s ease;
    }
    .menu-overlay.active { opacity: 1; pointer-events: all; }

    /* ===== Top Right Info ===== */
    .top-wrapper {
      position: fixed;
      top: 18px;
      right: 20px;
      display: flex;
      gap: 14px;
      z-index: 1000;
    }

    .top-info {
      background: rgba(30,41,59,0.85);
      padding: 12px 14px;
      border-radius: 14px;
      font-size: 0.85rem;
      min-width: 170px;
      text-align: right;
      box-shadow: 0 8px 20px rgba(0,0,0,0.4);
      backdrop-filter: blur(6px);
    }

    .location-text {
        font-size: 0.7rem;
        color: var(--muted);
        margin-bottom: 4px;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-weight: 600;
        display: block;
    }

    .region img {
      width: 24px;
      height: 16px;
      border-radius: 2px;
      vertical-align: middle;
      margin-right: 6px;
    }

    .time { font-weight: 700; margin-top: 4px; }
    .date { color: var(--muted); font-size: 0.75rem; }
    .weather { margin-top: 6px; font-size: 0.8rem; color: var(--accent); }

    /* ===== Main Card ===== */
    .card {
      max-width: 900px;
      width: 100%;
      background: linear-gradient(180deg, #0b1220, var(--card));
      border-radius: 20px;
      box-shadow: 0 40px 80px rgba(0,0,0,0.4);
      display: grid;
      grid-template-columns: 1fr 1fr;
      overflow: hidden;
      animation: fadeUp 1.2s ease-out;
      margin-top: 100px;
      margin-bottom: 140px;
    }

    .content {
      padding: 48px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 20px;
    }

    .eyebrow { text-transform: uppercase; letter-spacing: 0.12em; font-size: 0.75rem; color: var(--accent); }
    h1 { font-size: clamp(2rem, 4vw, 3rem); margin: 0; line-height: 1.15; }
    p { margin: 0; font-size: 1.05rem; color: var(--muted); max-width: 420px; }

    .image-panel { position: relative; background: #000; overflow: hidden; }
    .image-panel img { width: 100%; height: 100%; object-fit: cover; animation: slowFloat 6s ease-in-out infinite; }
    .image-panel::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(15,23,42,0.85), rgba(15,23,42,0.1), rgba(15,23,42,0));
    }

    .credit { position: absolute; bottom: 18px; left: 20px; font-size: 0.85rem; z-index: 2; }

    @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slowFloat { 0% { transform: scale(1) translateY(0); } 50% { transform: scale(1.02) translateY(-6px); } 100% { transform: scale(1) translateY(0); } }

    /* ===== FLAGS BAR ===== */
    .flags-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 80px;
      background: linear-gradient(to right, #020617, #0f172a);
      overflow: hidden;
      display: flex;
      align-items: center;
      z-index: 999;
      border-top: 2px solid rgba(56,189,248,0.3);
    }

    .flags-track {
      display: flex;
      gap: 20px;
      animation: moveFlags 500s linear infinite;
    }

    .flags-track.paused { animation-play-state: paused; }

    .flag {
      position: relative;
      width: 48px;
      height: 32px;
      flex-shrink: 0;
      cursor: pointer;
    }

    .flag img {
      width: 100%;
      height: 100%;
      border-radius: 4px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.5);
    }

    .flag span {
      position: absolute;
      bottom: 36px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.8);
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.7rem;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
      z-index: 10;
    }

    .flag.show span {opacity: 1;}

    @keyframes moveFlags { from { transform: translateX(0); } to { transform: translateX(-50%); } }

    /* ===== MOBILE FIXES ===== */
    @media (max-width: 800px) {
      .top-wrapper {
        position: relative;
        justify-content: center;
        margin-bottom: 15px;
        gap: 10px;
        margin-top: 60px;
      }
      .card { grid-template-columns: 1fr; margin-top: 0; }
      .content { padding: 36px 28px; }
      .image-panel { height: 320px; }
    }

    @media (max-width: 500px) {
      .top-info { min-width: 140px; }
      .card { display: flex; flex-direction: column; }
      .image-panel, .content { width: 100%; }
      .image-panel img { height: auto; }
    }

</style>
</head>
<body>
  <button id="hamburgerBtn" class="hamburger">
    &#9776;
  </button>

  <div class="menu-overlay" id="menuOverlay"></div>

  <div class="slide-menu" id="slideMenu">
    <button class="close-menu" id="closeMenuBtn">&times;</button>
    <a href="index.html" class="menu-item">Home</a>
    <a href="stories.html" class="menu-item">My Stories</a>
    <a href="learning.html" class="menu-item">Fun Learning</a>
    <a href="videos.html" class="menu-item">My Videos</a>
    <a href="chat.html" class="menu-item">Chat</a>
    <a href="about.html" class="menu-item">About Me</a>
  </div>

  <div class="flags-bar">
    <div class="flags-track" id="flagsTrack"></div>
  </div>

  <div class="top-wrapper">
    <div class="top-info">
      <span class="location-text">Where I now live</span>
      <div class="region"><img src="https://flagcdn.com/w20/gb.png" alt="UK Flag"></div>
      <div class="time" id="time-uk"></div>
      <div class="date" id="date-uk"></div>
      <div class="weather" id="weather-uk">Loading‚Ä¶</div>
    </div>

    <div class="top-info">
      <span class="location-text">Where I came from</span>
      <div class="region"><img src="https://flagcdn.com/w20/pk.png" alt="Pakistan Flag"></div>
      <div class="time" id="time-pk"></div>
      <div class="date" id="date-pk"></div>
      <div class="weather" id="weather-pk">Loading‚Ä¶</div>
    </div>
  </div>


  <div class="view-container">
    <div class="card" id="mainCard">
      <div class="content">
        <div class="chat-header">
            <h1 style="margin:0; color:var(--accent);">Chat with Yum right now!</h1>
            <button id="adminDelete" class="delete-btn" style="display:none;" onclick="clearHistory()">Clear History</button>
        </div>

        <div class="chat-portal">
          <div id="chatNameSection">
            <input type="text" id="userName" class="chat-input" placeholder="Your name...">
            <button class="chat-btn" onclick="startChat()" style="margin-top:10px; width:100%;">Join Chat Room</button>
          </div>
          
          <div id="chatBox">
            <div id="messages"></div>
            <div style="display:flex; padding:12px; gap:10px; background: rgba(0,0,0,0.2);">
              <input type="text" id="chatInput" class="chat-input" placeholder="Type a message...">
              <button class="chat-btn" onclick="sendMessage()">Send</button>
            </div>
          </div>
        </div>
      </div>
      <div class="image-panel"><img src="./20250809_120138.jpg"></div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>


  <script>
    /* ===== MENU FUNCTIONALITY ===== */
    const hamburgerBtn = document.getElementById('hamburgerBtn');
    const closeMenuBtn = document.getElementById('closeMenuBtn');
    const slideMenu = document.getElementById('slideMenu');
    const menuOverlay = document.getElementById('menuOverlay');

    function toggleMenu() {
      slideMenu.classList.toggle('open');
      menuOverlay.classList.toggle('active');
    }

    hamburgerBtn.addEventListener('click', toggleMenu);
    closeMenuBtn.addEventListener('click', toggleMenu);
    menuOverlay.addEventListener('click', toggleMenu);

    /* ===== FLAGS ===== */
    const countries = [
        {code:"af",name:"Afghanistan"},{code:"ax",name:"√Öland Islands"},{code:"al",name:"Albania"},{code:"dz",name:"Algeria"},
        {code:"as",name:"American Samoa"},{code:"ad",name:"Andorra"},{code:"ao",name:"Angola"},{code:"ai",name:"Anguilla"},
        {code:"aq",name:"Antarctica"},{code:"ag",name:"Antigua & Barbuda"},{code:"ar",name:"Argentina"},{code:"am",name:"Armenia"},
        {code:"aw",name:"Aruba"},{code:"au",name:"Australia"},{code:"at",name:"Austria"},{code:"az",name:"Azerbaijan"},
        {code:"bs",name:"Bahamas"},{code:"bh",name:"Bahrain"},{code:"bd",name:"Bangladesh"},{code:"bb",name:"Barbados"},
        {code:"by",name:"Belarus"},{code:"be",name:"Belgium"},{code:"bz",name:"Belize"},{code:"bj",name:"Benin"},
        {code:"bm",name:"Bermuda"},{code:"bt",name:"Bhutan"},{code:"bo",name:"Bolivia"},{code:"ba",name:"Bosnia & Herzegovina"},
        {code:"bw",name:"Botswana"},{code:"bv",name:"Bouvet Island"},{code:"br",name:"Brazil"},{code:"io",name:"Brit. Indian Ocean"},
        {code:"bn",name:"Brunei"},{code:"bg",name:"Bulgaria"},{code:"bf",name:"Burkina Faso"},{code:"bi",name:"Burundi"},
        {code:"kh",name:"Cambodia"},{code:"cm",name:"Cameroon"},{code:"ca",name:"Canada"},{code:"cv",name:"Cape Verde"},
        {code:"bq",name:"Caribbean NL"},{code:"ky",name:"Cayman Islands"},{code:"cf",name:"Central African Rep."},
        {code:"td",name:"Chad"},{code:"cl",name:"Chile"},{code:"cn",name:"China"},{code:"cx",name:"Christmas Island"},
        {code:"cc",name:"Cocos (Keeling)"},{code:"co",name:"Colombia"},{code:"km",name:"Comoros"},{code:"cg",name:"Congo (Rep.)"},
        {code:"cd",name:"Congo (DRC)"},{code:"ck",name:"Cook Islands"},{code:"cr",name:"Costa Rica"},{code:"ci",name:"C√¥te d‚ÄôIvoire"},
        {code:"hr",name:"Croatia"},{code:"cu",name:"Cuba"},{code:"cw",name:"Cura√ßao"},{code:"cy",name:"Cyprus"},{code:"cz",name:"Czechia"},
        {code:"dk",name:"Denmark"},{code:"dj",name:"Djibouti"},{code:"dm",name:"Dominica"},{code:"do",name:"Dominican Republic"},
        {code:"ec",name:"Ecuador"},{code:"eg",name:"Egypt"},{code:"sv",name:"El Salvador"},{code:"gq",name:"Equatorial Guinea"},
        {code:"er",name:"Eritrea"},{code:"ee",name:"Estonia"},{code:"sz",name:"Eswatini"},{code:"et",name:"Ethiopia"},
        {code:"fk",name:"Falkland Islands"},{code:"fo",name:"Faroe Islands"},{code:"fj",name:"Fiji"},{code:"fi",name:"Finland"},
        {code:"fr",name:"France"},{code:"gf",name:"French Guiana"},{code:"pf",name:"French Polynesia"},{code:"tf",name:"French S. Terr."},
        {code:"ga",name:"Gabon"},{code:"gm",name:"Gambia"},{code:"ge",name:"Georgia"},{code:"de",name:"Germany"},
        {code:"gh",name:"Ghana"},{code:"gi",name:"Gibraltar"},{code:"gr",name:"Greece"},{code:"gl",name:"Greenland"},
        {code:"gd",name:"Grenada"},{code:"gp",name:"Guadeloupe"},{code:"gu",name:"Guam"},{code:"gt",name:"Guatemala"},
        {code:"gg",name:"Guernsey"},{code:"gn",name:"Guinea"},{code:"gw",name:"Guinea-Bissau"},{code:"gy",name:"Guyana"},
        {code:"ht",name:"Haiti"},{code:"hm",name:"Heard & McDonald"},{code:"va",name:"Vatican City"},{code:"hn",name:"Honduras"},
        {code:"hk",name:"Hong Kong"},{code:"hu",name:"Hungary"},{code:"is",name:"Iceland"},{code:"in",name:"India"},
        {code:"id",name:"Indonesia"},{code:"ir",name:"Iran"},{code:"iq",name:"Iraq"},{code:"ie",name:"Ireland"},
        {code:"im",name:"Isle of Man"},{code:"il",name:"Israel"},{code:"it",name:"Italy"},{code:"jm",name:"Jamaica"},
        {code:"jp",name:"Japan"},{code:"je",name:"Jersey"},{code:"jo",name:"Jordan"},{code:"kz",name:"Kazakhstan"},
        {code:"ke",name:"Kenya"},{code:"ki",name:"Kiribati"},{code:"kp",name:"North Korea"},{code:"kr",name:"South Korea"},
        {code:"kw",name:"Kuwait"},{code:"kg",name:"Kyrgyzstan"},{code:"la",name:"Laos"},{code:"lv",name:"Latvia"},
        {code:"lb",name:"Lebanon"},{code:"ls",name:"Lesotho"},{code:"lr",name:"Liberia"},{code:"ly",name:"Libya"},
        {code:"li",name:"Liechtenstein"},{code:"lt",name:"Lithuania"},{code:"lu",name:"Luxembourg"},{code:"mo",name:"Macao"},
        {code:"mg",name:"Madagascar"},{code:"mw",name:"Malawi"},{code:"my",name:"Malaysia"},{code:"mv",name:"Maldives"},
        {code:"ml",name:"Mali"},{code:"mt",name:"Malta"},{code:"mh",name:"Marshall Islands"},{code:"mq",name:"Martinique"},
        {code:"mr",name:"Mauritania"},{code:"mu",name:"Mauritius"},{code:"yt",name:"Mayotte"},{code:"mx",name:"Mexico"},
        {code:"fm",name:"Micronesia"},{code:"md",name:"Moldova"},{code:"mc",name:"Monaco"},{code:"mn",name:"Mongolia"},
        {code:"me",name:"Montenegro"},{code:"ms",name:"Montserrat"},{code:"ma",name:"Morocco"},{code:"mz",name:"Mozambique"},
        {code:"mm",name:"Myanmar"},{code:"na",name:"Namibia"},{code:"nr",name:"Nauru"},{code:"np",name:"Nepal"},
        {code:"nl",name:"Netherlands"},{code:"nc",name:"New Caledonia"},{code:"nz",name:"New Zealand"},{code:"ni",name:"Nicaragua"},
        {code:"ne",name:"Niger"},{code:"ng",name:"Nigeria"},{code:"nu",name:"Niue"},{code:"nf",name:"Norfolk Island"},
        {code:"mk",name:"North Macedonia"},{code:"mp",name:"N. Mariana Is."},{code:"no",name:"Norway"},{code:"om",name:"Oman"},
        {code:"pk",name:"Pakistan"},{code:"pw",name:"Palau"},{code:"ps",name:"Palestine"},{code:"pa",name:"Panama"},
        {code:"pg",name:"Papua New Guinea"},{code:"py",name:"Paraguay"},{code:"pe",name:"Peru"},{code:"ph",name:"Philippines"},
        {code:"pn",name:"Pitcairn"},{code:"pl",name:"Poland"},{code:"pt",name:"Portugal"},{code:"pr",name:"Puerto Rico"},
        {code:"qa",name:"Qatar"},{code:"re",name:"R√©union"},{code:"ro",name:"Romania"},{code:"ru",name:"Russia"},
        {code:"rw",name:"Rwanda"},{code:"bl",name:"St. Barth√©lemy"},{code:"sh",name:"St. Helena"},{code:"kn",name:"St. Kitts & Nevis"},
        {code:"lc",name:"St. Lucia"},{code:"mf",name:"St. Martin"},{code:"pm",name:"St. Pierre & Miq."},
        {code:"vc",name:"St. Vincent & Gren."}, {code:"ws",name:"Samoa"},{code:"sm",name:"San Marino"},
        {code:"st",name:"S√£o Tom√© & Pr√≠ncipe"},{code:"sa",name:"Saudi Arabia"},{code:"sn",name:"Senegal"},{code:"rs",name:"Serbia"},
        {code:"sc",name:"Seychelles"},{code:"sl",name:"Sierra Leone"},{code:"sg",name:"Singapore"},{code:"sx",name:"Sint Maarten"},
        {code:"sk",name:"Slovakia"},{code:"si",name:"Slovenia"},{code:"sb",name:"Solomon Islands"},{code:"so",name:"Somalia"},
        {code:"za",name:"South Africa"},{code:"gs",name:"S. Geo. & S. Sand."}, {code:"ss",name:"South Sudan"},
        {code:"es",name:"Spain"},{code:"lk",name:"Sri Lanka"},{code:"sd",name:"Sudan"},{code:"sr",name:"Suriname"},
        {code:"sj",name:"Svalbard & Jan Mayen"},{code:"se",name:"Sweden"},{code:"ch",name:"Switzerland"},{code:"sy",name:"Syria"},
        {code:"tw",name:"Taiwan"},{code:"tj",name:"Tajikistan"},{code:"tz",name:"Tanzania"},{code:"th",name:"Thailand"},
        {code:"tl",name:"Timor-Leste"},{code:"tg",name:"Togo"},{code:"tk",name:"Tokelau"},{code:"to",name:"Tonga"},
        {code:"tt",name:"Trinidad & Tobago"},{code:"tn",name:"Tunisia"},{code:"tr",name:"Turkey"},{code:"tm",name:"Turkmenistan"},
        {code:"tc",name:"Turks & Caicos"},{code:"tv",name:"Tuvalu"},{code:"ug",name:"Uganda"},{code:"ua",name:"Ukraine"},
        {code:"ae",name:"UAE"},{code:"gb",name:"United Kingdom"},{code:"us",name:"United States"},{code:"uy",name:"Uruguay"},
        {code:"uz",name:"Uzbekistan"},{code:"vu",name:"Vanuatu"},{code:"ve",name:"Venezuela"},{code:"vn",name:"Vietnam"},
        {code:"wf",name:"Wallis & Futuna"},{code:"eh",name:"Western Sahara"},{code:"ye",name:"Yemen"},{code:"zm",name:"Zambia"},
        {code:"zw",name:"Zimbabwe"}
    ];

    const track = document.getElementById("flagsTrack");
    const all = [...countries, ...countries];

    let activeFlag = null;

    all.forEach(c => {
      const div = document.createElement("div");
      div.className = "flag";
      div.innerHTML = `<img src="https://flagcdn.com/w80/${c.code}.png" alt="${c.name}"><span>${c.name}</span>`;
      track.appendChild(div);

      div.addEventListener("mouseenter", () => { track.classList.add("paused"); div.classList.add("show"); });
      div.addEventListener("mouseleave", () => { if(activeFlag===null){ track.classList.remove("paused"); div.classList.remove("show"); } });

      div.addEventListener("pointerdown", () => {
        if(/Mobi|Android/i.test(navigator.userAgent)){
          if(activeFlag && activeFlag!==div) return;
          const isActive = div.classList.contains("show");
          if(isActive){ div.classList.remove("show"); track.classList.remove("paused"); activeFlag=null; }
          else { div.classList.add("show"); track.classList.add("paused"); activeFlag=div; }
        }
      });
    });

    /* ===== Time & Weather ===== */
    function updateTime(zone, timeId, dateId){
      const now = new Date();
      document.getElementById(timeId).textContent =
        now.toLocaleTimeString("en-GB",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:true,timeZone:zone});
      document.getElementById(dateId).textContent =
        now.toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric",timeZone:zone});
    }

    setInterval(()=>{
      updateTime("Europe/London","time-uk","date-uk");
      updateTime("Asia/Karachi","time-pk","date-pk");
    },1000);

    function loadWeather(lat,lon,elId,label){
      fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`)
        .then(res=>res.json())
        .then(data=>{
          const temp=Math.round(data.current_weather.temperature);
          const code=data.current_weather.weathercode;
          let icon="‚òÄÔ∏è";
          if([1,2,3].includes(code)) icon="‚õÖ";
          if([45,48].includes(code)) icon="üå´Ô∏è";
          if([51,53,55,61,63,65,80].includes(code)) icon="üåßÔ∏è";
          if([71,73,75,85].includes(code)) icon="‚ùÑÔ∏è";
          if([95,96,99].includes(code)) icon="‚õàÔ∏è";
          document.getElementById(elId).textContent=`${label} ${icon} ${temp}¬∞C`;
        });
    }

    loadWeather(52.57,-1.82,"weather-uk","Birmingham");
    loadWeather(33.69,73.06,"weather-pk","Islamabad");

  </script>


  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBWwSAuseEPvBoFiPHaZoFNiLV6xhBSeAJI",
      authDomain: "abdulrafaychat.firebaseapp.com",
      projectId: "abdulrafaychat",
      storageBucket: "abdulrafaychat.firebasestorage.app",
      messagingSenderId: "1078346470566",
      appId: "1:1078346470566:web:489a0d85d89216e5e39067",
      databaseURL: "https://abdulrafaychat-default-rtdb.firebaseio.com"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let currentUserName = "";

function startChat() {
  const name = document.getElementById('userName').value.trim();
  if (!name) return alert("Enter a name");
  
  currentUserName = name;
  
  // These lines only hide/show elements INSIDE the card
  document.getElementById('chatNameSection').style.display = 'none';
  document.getElementById('chatBox').style.display = 'flex';
  document.getElementById('adminDelete').style.display = 'block';

  // The email fetch happens in the background and won't remove layout elements
  fetch("https://formsubmit.co/ajax/adbrain@gmail.com", {
    method: "POST", 
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ 
        _subject: "üöÄ " + name + " joined the chat!",
        name: name,
        message: name + " is now online.",
        cc: "adnan.sattar.k@gmail.com"
    })
  });

  // Re-verify the clock is still running
  updateClocks(); 

  db.ref("messages").on("child_added", (snap) => {
    const d = snap.val();
    appendMessage(d.user, d.text, d.user === currentUserName, d.time);
  });
}
    // Keyboard "Enter" support
    document.getElementById('chatInput').addEventListener('keypress', function (e) {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });

    function sendMessage() {
      const input = document.getElementById('chatInput');
      if (!input.value.trim()) return;
      
     const now = new Date().toLocaleDateString([], {day:'2-digit', month:'short'}) + " " + new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      
      db.ref("messages").push().set({
        user: currentUserName,
        text: input.value,
        time: now // Store timestamp
      });
      input.value = "";
    }

    function appendMessage(user, text, isMe, time) {
      const div = document.createElement('div');
      div.className = isMe ? 'msg me' : 'msg';
      // Added time display
      div.innerHTML = `<strong>${user}</strong><br>${text}<span class="ts">${time || ''}</span>`;
      const box = document.getElementById('messages');
      box.appendChild(div);
      box.scrollTop = box.scrollHeight;
    }

    function clearHistory() {
      const pw = prompt("Enter Admin Password:");
      if (pw === "71797179") { // Updated Password
        if (confirm("Delete ALL messages from the database?")) {
          db.ref("messages").remove();
          alert("History Deleted.");
        }
      } else if (pw !== null) {
        alert("Wrong password.");
      }
    }
  </script>
</body>

</html>

